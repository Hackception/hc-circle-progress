<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html">
<link rel="import" href="svg-util-behavior.html">

<script>
  /* global hc */
  // Ensure our namespace is available
  window.hc = window.hc || {};

  /** @polymerBehavior */
  hc.SvgProgressBehavior = [Polymer.IronResizableBehavior, hc.SvgUtilBehavior, {
    properties: {
      /**
       * Value of circular progress bar.
       */
      value: {
        type: Number,
        value: 0
      },

      /**
       * Maximum of value.
       */
      max: {
        type: Number,
        value: 100
      },

      /**
       * Minimum value
       */
      min: {
        type: Number,
        value: 0
      },

      /**
       * Stroke width of circle.
       */
      strokeWidth: {
        type: Number,
        value: 4
      },
      strokeUnit: {
        type: String,
        value: 'px'
      },

      _dasharray: {
        type: Number
      },

      _dashoffset: {
        type: Number,
        computed: '_computeDashOffset(min, value, max, _dasharray)'
      }
    },

    // Calculate the dash-array
    _computeDashArray(el) {
      this._dasharray = this.getTotalLength(el);
    },

    /**
     * Calculate the dash-offset
     *
     * @param {Number} min
     * @param {Number} value
     * @param {Number} max
     * @param {Number} dasharray - Size of the total path length
     * @returns {Number} progress of the dasharray
     * @private
     */
    _computeDashOffset(min, value, max, dasharray) {
      if (!value || !dasharray || !max) return dasharray;
      return (dasharray - (((value - min) / (max - min)) * dasharray)) || dasharray;
    }

  }];

</script>
